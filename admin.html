<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Paneli | Abdullah Cihan</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" referrerpolicy="no-referrer">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="admin.css">
    <link rel="stylesheet" href="admin-pages.css">
</head>
<body>

    <div id="toast-container"></div>

    <div class="admin-container">

        <aside class="admin-sidebar glass">
            <div class="sidebar-header">
                <h2>Admin<span>.</span></h2>
            </div>

            <ul class="admin-menu">
                <li class="active" onclick="showSection('dashboard')"><i class="fa-solid fa-chart-pie"></i> Özet</li>
                <li onclick="showSection('posts')"><i class="fa-solid fa-layer-group"></i> Yazılar</li>
                <li onclick="showSection('new-post')"><i class="fa-solid fa-pen-to-square"></i> Yeni Yazı Ekle</li>
                <li onclick="showSection('tools-manager')"><i class="fa-solid fa-toolbox"></i> Araç Yönetimi</li>
                <li onclick="showSection('pages-manager')"><i class="fa-solid fa-file-code"></i> Sayfalar</li>
                <li onclick="showSection('settings')"><i class="fa-solid fa-gear"></i> Ayarlar & Yedek</li>
            </ul>

            <div class="sidebar-footer">
                <a href="index.html" class="btn-logout" target="_blank" rel="noopener noreferrer">
                    <i class="fa-solid fa-arrow-up-right-from-square"></i> Siteyi Gör
                </a>
            </div>
        </aside>

        <main class="admin-content">

            <header class="admin-header glass">
                <h3>Yönetim Paneli</h3>

                <div class="user-info" onclick="toggleProfileMenu()" id="user-profile-trigger">
                    <span>Abdullah Cihan</span>
                    <img src="https://placehold.co/100x100/1e293b/white?text=AC" alt="Admin">

                    <div class="profile-dropdown" id="profile-dropdown">
                        <a href="#" onclick="showSection('settings')"><i class="fa-solid fa-sliders"></i> Ayarlar</a>
                        <a href="#" onclick="logout()" class="dropdown-logout"><i class="fa-solid fa-right-from-bracket"></i> Çıkış Yap</a>
                    </div>
                </div>
            </header>

            <section id="dashboard" class="admin-section active">
                <div class="stats-grid">
                    <div class="stat-card glass">
                        <div class="stat-icon icon-blue"><i class="fa-solid fa-file-lines"></i></div>
                        <div><h4>Toplam Yazı</h4><span id="total-posts-count">0</span></div>
                    </div>
                    <div class="stat-card glass">
                        <div class="stat-icon icon-green"><i class="fa-solid fa-layer-group"></i></div>
                        <div><h4>Kategoriler</h4><span id="total-cats-count">0</span></div>
                    </div>
                    <div class="stat-card glass">
                        <div class="stat-icon icon-purple"><i class="fa-solid fa-server"></i></div>
                        <div><h4>Depolama</h4><span>LocalStorage</span></div>
                    </div>
                </div>
            </section>

            <section id="posts" class="admin-section">
                <div class="section-top">
                    <h2>Tüm Yazılar</h2>
                    <div class="actions-right">
                        <input type="text" id="search-posts" placeholder="Yazı ara..." onkeyup="filterPosts()" class="search-input">
                        <button onclick="showSection('new-post')" class="btn-add"><i class="fa-solid fa-plus"></i> Yeni Ekle</button>
                    </div>
                </div>

                <div class="table-responsive glass">
                    <table class="posts-table">
                        <thead>
                            <tr>
                                <th>Görsel</th>
                                <th>Başlık</th>
                                <th>Kategori</th>
                                <th>Durum</th>
                                <th>İşlemler</th>
                            </tr>
                        </thead>
                        <tbody id="posts-table-body"></tbody>
                    </table>
                </div>
            </section>

            <section id="new-post" class="admin-section">
                <div class="editor-wrapper glass">
                    <div class="form-header">
                        <h2>Yeni Yazı Oluştur</h2>
                    </div>

                    <form id="add-post-form" onsubmit="return false;">
                        <div class="form-row">
                            <div class="form-group flex-2">
                                <label>Yazı Başlığı</label>
                                <input type="text" id="post-title" placeholder="Başlık giriniz..." required>
                            </div>
                            <div class="form-group flex-1">
                                <label>Tarih</label>
                                <input type="text" id="post-date">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group flex-1">
                                <label>Kategori</label>
                                <div class="input-group">
                                    <select id="post-category"></select>
                                    <button type="button" onclick="addNewCategory()" class="btn-icon"><i class="fa-solid fa-plus"></i></button>
                                </div>
                            </div>
                            <div class="form-group flex-1">
                                <label>Okuma Süresi</label>
                                <input type="text" id="read-time" disabled style="opacity:0.7">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Kapak Görseli / İkon</label>
                            <input type="text" id="post-image" placeholder="URL veya 'fa-brands fa-python' gibi ikon kodu">
                        </div>

                        <div class="form-group">
                            <label>Kısa Açıklama</label>
                            <textarea id="post-desc" rows="2"></textarea>
                        </div>

                        <div class="form-group">
                            <label>İçerik</label>
                            <div id="editor-container" style="height: 350px;"></div>
                        </div>

                        <div class="form-group">
                            <label>Etiketler</label>
                            <div class="tags-input-container">
                                <ul id="tags-list"></ul>
                                <input type="text" id="tags-input" placeholder="Etiket yaz ve Enter'a bas">
                            </div>
                        </div>

                        <div class="form-group checkbox-group">
                            <input type="checkbox" id="post-featured">
                            <label for="post-featured">Öne Çıkanlara Ekle</label>
                        </div>

                        <div class="form-footer">
                            <button type="button" onclick="savePost('draft')" class="btn-draft">Taslak Kaydet</button>
                            <button type="button" onclick="savePost('published')" class="btn-submit">Yayınla</button>
                        </div>
                    </form>
                </div>
            </section>

            <section id="tools-manager" class="admin-section">
                <div class="settings-container glass">
                    <h2><i class="fa-solid fa-toolbox"></i> Hızlı Araçlar Yönetimi</h2>
                    <p style="color:#94a3b8; margin-bottom:20px;">Sol menüde görünen araçları buradan ekleyip çıkarabilirsiniz.</p>

                    <div class="glass" style="padding:20px; background:rgba(255,255,255,0.03); border-radius:12px; margin-bottom:30px;">
                        <h4 style="margin-bottom:15px; color:white;">Yeni Araç Ekle</h4>
                        <div class="form-row">
                            <div class="form-group flex-1">
                                <input type="text" id="tool-title" placeholder="Araç Adı (Örn: Kelime Sayacı)">
                            </div>
                            <div class="form-group flex-1">
                                <input type="text" id="tool-icon" placeholder="İkon (Örn: fa-solid fa-pen)">
                            </div>
                            <div class="form-group flex-1">
                                <input type="text" id="tool-link" placeholder="Link (Örn: # veya https://...)">
                            </div>
                            <button type="button" onclick="addTool()" class="btn-submit" style="height:45px; margin-top:2px;">Ekle</button>
                        </div>
                        <small style="color:#64748b;">
                            İkonlar için
                            <a href="https://fontawesome.com/search?o=r&m=free" target="_blank" rel="noopener noreferrer" style="color:#3b82f6;">FontAwesome</a>
                            kullanabilirsiniz.
                        </small>
                    </div>

                    <h4 style="margin-bottom:15px; color:white;">Mevcut Araçlar</h4>
                    <div class="table-responsive">
                        <table class="posts-table">
                            <thead>
                                <tr>
                                    <th width="50">İkon</th>
                                    <th>Başlık</th>
                                    <th>Link</th>
                                    <th width="80">İşlem</th>
                                </tr>
                            </thead>
                            <tbody id="tools-table-body"></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="pages-manager" class="admin-section">
                <div class="section-top">
                    <h2>Oluşturulan Sayfalar</h2>
                    <button type="button" onclick="openNewPageEditor()" class="btn-add"><i class="fa-solid fa-plus"></i> Sayfa Oluştur</button>
                </div>

                <div class="table-responsive glass">
                    <table class="posts-table">
                        <thead>
                            <tr>
                                <th>Sayfa Başlığı</th>
                                <th>Tarih</th>
                                <th>Link</th>
                                <th>İşlemler</th>
                            </tr>
                        </thead>
                        <tbody id="pages-table-body"></tbody>
                    </table>
                </div>
            </section>

            <section id="page-editor" class="admin-section">
                <div class="editor-wrapper glass">
                    <div class="form-header">
                        <h2 id="page-form-title">Yeni Sayfa Oluştur</h2>
                        <button type="button" onclick="showSection('pages-manager')" class="btn-draft">Vazgeç</button>
                    </div>

                    <div class="form-group">
                        <label>Sayfa Başlığı</label>
                        <input type="text" id="page-title" placeholder="Örn: Vize Hesaplama Aracı">
                    </div>

                    <div class="form-group">
                        <label>Sayfa İçeriği (HTML / CSS / JS)</label>
                        <textarea id="page-content" rows="14"
                            style="font-family: monospace; color:#a5b4fc; background:#0b1120; width:100%; padding:15px; border-radius:8px; border:1px solid rgba(255,255,255,0.1);"
                            placeholder="<!DOCTYPE html><html>... Kodlarını buraya yapıştır ...</html>"></textarea>
                        <small style="color:#64748b;">Not: Buraya yazdığınız kod, "tool-view.html" içinde çalıştırılacaktır.</small>
                    </div>

                    <button type="button" onclick="savePage()" id="btn-save-page" class="btn-submit" style="width: 100%;">
                        <i class="fa-solid fa-floppy-disk"></i> Kaydet
                    </button>
                </div>
            </section>

            <section id="settings" class="admin-section">
                <div class="settings-container glass">
                    <h2><i class="fa-solid fa-database"></i> Veri Yedekleme & Geri Yükleme</h2>
                    <p style="color:#94a3b8; margin-bottom:20px;">Siteniz "LocalStorage" kullandığı için verilerinizi düzenli olarak yedekleyiniz.</p>

                    <div class="backup-grid">
                        <div class="backup-card">
                            <h4><i class="fa-solid fa-download"></i> Yedek Al</h4>
                            <p>Tüm verileri JSON olarak indir.</p>
                            <button type="button" onclick="exportData()" class="btn-submit" style="width:100%">Verileri İndir</button>
                        </div>

                        <div class="backup-card">
                            <h4><i class="fa-solid fa-upload"></i> Yedeği Yükle</h4>
                            <p>JSON dosyasını geri yükle.</p>
                            <input type="file" id="import-file" style="display:none" onchange="importData(this)">
                            <button type="button" onclick="document.getElementById('import-file').click()" class="btn-draft" style="width:100%">Dosya Seç ve Yükle</button>
                        </div>
                    </div>
                </div>

                <div class="backup-card" style="margin-top:20px;">
                    <h4><i class="fa-solid fa-key"></i> Şifre Değiştir</h4>
                    <p>Mevcut şifreyi doğrulayarak yeni şifre belirle.</p>

                    <input id="cp-username" placeholder="Mevcut kullanıcı adı" style="margin-bottom:10px;">
                    <input id="cp-old" type="password" placeholder="Mevcut şifre" style="margin-bottom:10px;">
                    <input id="cp-new-user" placeholder="Yeni kullanıcı adı (opsiyonel)" style="margin-bottom:10px;">
                    <input id="cp-new" type="password" placeholder="Yeni şifre (en az 8)" style="margin-bottom:10px;">

                    <button type="button" class="btn-submit" style="width:100%" onclick="changePassword()">Güncelle</button>
                </div>
            </section>

        </main>
    </div>

    <!-- SCRIPTS: Modüler sıra -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

    <script src="admin.js"></script>
    <script src="admin-posts.js"></script>
    <script src="admin-tools.js"></script>
    <script src="admin-pages.js"></script>
</body>
</html>
